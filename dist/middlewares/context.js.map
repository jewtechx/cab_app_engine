{"version":3,"file":"context.js","sourceRoot":"/","sources":["middlewares/context.ts"],"names":[],"mappings":";;;AACA,0CAA2C;AAS3C,SAA8B,UAAU,CAAE,GAAe,EAAC,GAAY,EAAC,IAAiB;;QACtF,IAAI;YACF,MAAM,KAAK,GAAG,GAAG,CAAC,OAAO,CAAC,aAAa,IAAI,EAAE,CAAC;YAE9C,IAAI,KAAK,EAAE;gBACT,MAAM,OAAO,GAAQ,MAAM,IAAA,iBAAS,EAAC,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;gBAE1D,MAAM,EAAE,GAAG,OAAO,CAAC,GAAG,CAAC;gBAEvB,MAAM,IAAI,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,CAAC;gBAEzB,GAAG,CAAC,IAAI,GAAG,IAAI,CAAC;gBAChB,IAAI,EAAE,CAAA;aACP;SACF;QAAC,OAAO,GAAG,EAAE;YACZ,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;SAClB;IACH,CAAC;CAAA;AAjBD,6BAiBC;AAAA,CAAC","sourcesContent":["import { NextFunction } from 'express';\nimport { verifyJwt } from '../utils/token';\nimport { JwtPayload } from 'jsonwebtoken';\nimport { Request,Response } from 'express';\n\ninterface AuthRequest extends Request \n{\n  user?: JwtPayload\n}\n\nexport default async function setContext (req:AuthRequest,res:Response,next:NextFunction){\n  try {\n    const token = req.headers.authorization || '';\n    \n    if (token) {\n      const decoded: any = await verifyJwt(token.split(' ')[1]);\n\n      const id = decoded._id;\n\n      const user = { _id: id };\n\n      req.user = user;\n      next()\n    }\n  } catch (err) {\n    console.log(err);\n  }\n};\n"]}